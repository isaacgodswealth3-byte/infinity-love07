<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Programmed Love</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
  height:100vh;
  overflow:hidden;
  background:radial-gradient(circle at bottom,#24002f 0%,#000 70%);
  font-family:'Times New Roman',serif;
  color:white;
}

/* SCENE */
#scene{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:flex-end;
}

/* HEART */
#heart{
  position:relative;
  width:700px;
  height:700px;
}

/* TEXT PARTICLES */
.love{
  position:absolute;
  font-size:18px;
  color:#ff8ad6;
  white-space:nowrap;
  opacity:0;
  text-shadow:
    0 0 6px #fff,
    0 0 16px #ff4de8,
    0 0 32px #ff4de8;
}

/* ROSE STEM */
.stem{
  position:absolute;
  bottom:0;
  width:2px;
  background:linear-gradient(to top,#0f0,#7f7);
  animation:grow 2s forwards;
}

@keyframes grow{
  from{height:0}
  to{height:120px}
}

/* PETALS */
.petal{
  position:absolute;
  width:10px;
  height:10px;
  background:radial-gradient(circle,#ff4d6d,#b3003c);
  border-radius:50% 50% 50% 0;
  transform:rotate(45deg);
  animation:float linear infinite;
}

@keyframes float{
  from{transform:translateY(0) rotate(0deg)}
  to{transform:translateY(-120vh) rotate(360deg)}
}

/* BLOOM SPARK */
.spark{
  position:absolute;
  width:6px;
  height:6px;
  background:gold;
  border-radius:50%;
  animation:spark 1s forwards;
}

@keyframes spark{
  to{
    transform:translate(var(--x),var(--y)) scale(0);
    opacity:0;
  }
}
</style>
</head>

<body>

<div id="scene">
  <div id="heart"></div>
</div>

<script>
const heart = document.getElementById("heart");
const TOTAL = 900;
let index = 0;
let particles = [];
let formed = false;

/* HEART PATH */
function heartPoint(t){
  return {
    x:16*Math.pow(Math.sin(t),3),
    y:13*Math.cos(t)
     -5*Math.cos(2*t)
     -2*Math.cos(3*t)
     -Math.cos(4*t)
  };
}

/* GENERATE TEXT ONE BY ONE (THIS IS THE KEY FIX) */
function generate(){
  if(index >= TOTAL) return;

  const span = document.createElement("span");
  span.className = "love";
  span.textContent = "I love you";

  // START FROM GROUND
  let startX = 350 + (Math.random()*100 - 50);
  let startY = 700;

  span.style.left = startX + "px";
  span.style.top = startY + "px";

  heart.appendChild(span);

  const t = (index / TOTAL) * Math.PI * 2;
  const h = heartPoint(t);

  particles.push({
    el: span,
    x: startX,
    y: startY,
    tx: 350 + h.x * 20,
    ty: 350 - h.y * 20
  });

  index++;
  setTimeout(generate, 25); // SPEED OF GROWTH
}

generate();

/* ANIMATION LOOP */
function animate(){
  particles.forEach(p=>{
    p.x += (p.tx - p.x) * 0.05;
    p.y += (p.ty - p.y) * 0.05;

    p.el.style.left = p.x + "px";
    p.el.style.top = p.y + "px";
    p.el.style.opacity = 1;
  });

  if(index >= TOTAL && !formed){
    formed = true;
    bloom();
  }

  requestAnimationFrame(animate);
}
animate();

/* BLOOM SPARKLES */
function bloom(){
  for(let i=0;i<250;i++){
    const s=document.createElement("div");
    s.className="spark";
    s.style.left="50%";
    s.style.top="50%";
    s.style.setProperty("--x",(Math.random()*700-350)+"px");
    s.style.setProperty("--y",(Math.random()*700-350)+"px");
    document.body.appendChild(s);
    setTimeout(()=>s.remove(),1000);
  }
}

/* ROSE PETALS GROWING FROM GROUND */
for(let i=0;i<35;i++){
  const p=document.createElement("div");
  p.className="petal";
  p.style.left=Math.random()*100+"vw";
  p.style.animationDuration=(6+Math.random()*6)+"s";
  document.body.appendChild(p);
}
</script>

</body>
</html>